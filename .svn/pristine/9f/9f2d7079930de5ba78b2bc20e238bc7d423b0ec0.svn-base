<%@ page language="java" contentType="text/html; charset=UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<script type="text/javascript" src="/resources/js/jquery.min.js"></script>
<script type="text/javascript"></script>
<script>
$(function(){
	//학교 코드
	let schulCode = "${schulPsitnMberVO.schulCode}";
	
	//클래스 등록
	$("#createBtn").on("click",function(){
		let clasYear = $("#clasYear").val();//년도
		let grade = $("#grade").val();//학년
		let clasNm = $("#clasNm").val();//반 명
		
		if(clasYear==""){
			Swal.fire({
				  icon : "warning",
			      title: "생성 연도를 입력해주세요 !"
			    })
			return;
		}else if(grade==null){
			Swal.fire({
				  icon : "warning",
			      title: "학년을 선택해주세요 !"
			    })
			   return;
		}else if(clasNm==""){
			 Swal.fire({
				  icon : "warning",
			      title: "반을 입력해주세요 !"
			    })
			 return;
		}
		
		//공통 학년
		let cmmnGrade = "";
			if(grade === "1"){ cmmnGrade = "A22001"; }
			if(grade === "2"){ cmmnGrade = "A22002"; }
			if(grade === "3"){ cmmnGrade = "A22003"; }
			if(grade === "4"){ cmmnGrade = "A22004"; }
			if(grade === "5"){ cmmnGrade = "A22005"; }
			if(grade === "6"){ cmmnGrade = "A22006"; }
			console.log("cmmnGrade", cmmnGrade);
		
		console.log("schulCode",schulCode);
	
		let data = {
				"clasYear":clasYear,
				"clasNm":clasNm,//"clasNm":clasNm+"반",
				"cmmnGrade":cmmnGrade,
				"schulCode":schulCode
		}
	
		console.log("data : ", data);
		
		$.ajax({
			url:"/class/classCreateAjax",
			contentType:"application/json;charset=utf-8",
			data:JSON.stringify(data),
			type:"post",
			dataType:"text",
			beforeSend:function(xhr){
				xhr.setRequestHeader("${_csrf.headerName}","${_csrf.token}");
			},success:function(result){
				console.log("0실패, 1성공 : ", result);
				//result : 0 => 실패
				//result : 1 => 성공
				if(result=="0"){
					Swal.fire({
						icon : "error",
						title: "이미 존재하는 클래스입니다."
						})
					return;
				}else{
					Swal.fire({
						icon : "success",
						title: "클래스가 생성되었습니다."
						}).then(result => {
							if (result.isConfirmed) { // 만약 모달창에서 confirm 버튼을 눌렀다면
								location.href = "/class/classList?schulCode="+schulCode;
							}
						});
				}
			}
		}); //ajax끝
	});//등록 끝
	
});
</script>
<style>
.input-mark-inner {
	margin-bottom: 50px; /* 원하는 여백 값으로 조정 */
}
</style>

<div class="sparkline12-list mt-b-30">
	<div class="sparkline12-hd">
		<div class="main-sparkline12-hd">
			<h1>클래스 생성</h1>
		</div>
	</div>
	<div class="sparkline12-graph">
		<div class="input-knob-dial-wrap">
			<div class="row">
				<div class="col-lg-2 col-md-2 col-sm-2 col-xs-12">
					<div class="input-mask-title">
						<label>학교 명</label>
					</div>
				</div>
				
				<div class="col-lg-10 col-md-10 col-sm-10 col-xs-12">
					<div class="input-mark-inner mg-b-22">
						<input type="text" class="form-control" value="${schulPsitnMberVO.schulNm}" readonly />
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-lg-2 col-md-2 col-sm-2 col-xs-12">
					<div class="input-mask-title">
						<label>연도</label>
					</div>
				</div>
				<div class="col-lg-10 col-md-10 col-sm-10 col-xs-12">
					<div class="input-mark-inner mg-b-22">
						<input type="number" id="clasYear" class="form-control" placeholder="숫자만 입력하세요" />
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-lg-2 col-md-2 col-sm-2 col-xs-12">
					<div class="input-mask-title">
						<label>학년</label>
					</div>
				</div>
				<div class="col-lg-10 col-md-10 col-sm-10 col-xs-12">
					<div class="input-mark-inner mg-b-22">
						<select class="form-control" id="grade">
							  <option disabled selected hidden>선택</option>
							  <option value="1">1학년</option>
							  <option value="2">2학년</option>
							  <option value="3">3학년</option>
							  <option value="4">4학년</option>
							  <option value="5">5학년</option>
							  <option value="6">6학년</option>
						</select>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-lg-2 col-md-2 col-sm-2 col-xs-12">
					<div class="input-mask-title">
						<label>반</label>
					</div>
				</div>
				<div class="col-lg-10 col-md-10 col-sm-10 col-xs-12">
					<div class="input-mark-inner mg-b-22">
						<input type="text" id="clasNm" class="form-control" placeholder="숫자만 입력하세요" required />
					</div>
				</div>
			</div>
			<div class="col-md-10 text-right">
				<button type="button" id="createBtn"
					class="btn btn-custon-rounded-two btn-primary">등록</button>
			</div>

		</div>
	</div>
</div>